{% extends 'layouts/base.njk' %}

{% set pageTitle = title + ' | Text' %}
{% set usesBlock = true %}

{% block content %}
  <main id="main" class="text h-entry l-stack" tabindex="-1" lang={{ locale }}>
    {% include "components/blog/blog-header.njk" %}
    <div class="main-grid-content e-content md-content" data-text-body>
      {{ content | safe }}
    </div>
    {%- set currentPostMentions = webmentions | webmentionsForPage(permalink) -%}
    {% if currentPostMentions.likes.length %}
      <section
        class="main-grid-content"
        aria-label="Post likes"
      >
        {%- set postMentionCount = webmentions | webmentionCountForPage(permalink) -%}
        <h2 class="pagination-navigation__sub-headline type-all-small-caps">Liked by {{ currentPostMentions.likes.length }} friendly folks.</h2>
        <ul class="webmention-likes">
          {% for post in currentPostMentions.likes %}

            <li><a
              href="{{ post.author.url }}"
              aria-label="Profile of {{ post.author.name }}"
            >
              <img
                src="{{ post.author.photo }}"
                alt="{{ post.author.name }}"
                data-process-image
                data-image-widths="[32, 64]"
                data-image-sizes="2rem"
              >
            </a>
          {% endfor %}
        </ul>
      </section>
    {% endif %}
    {% if tags.length %}
      <section
        role="region"
        class="text__pagination main-grid-content"
        aria-labelledby="pgntn-hdln"
      >
        <h2 class="pagination-navigation__sub-headline type-all-small-caps">Filed under</h2>
        <ul class="inline-list" role="list">
          {% for tag in tags | getCategories %}
            <li>
              <a
                href="{{ tag | categoryPermalink(categoryBase) }}"
              >
                {{ tag | capitaliser }}
              </a>
            </li>
          {% endfor %}
        </ul>
      </section>
    {% endif %}
    {% if changes %}
      {% include "components/blog/changelog.njk" %}
    {% endif %}
  </main>
{% endblock %}